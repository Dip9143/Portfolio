<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width,initial-scale=1" name="viewport">
  <meta content="description" name="description">
  <meta name="google" content="notranslate" />
  <meta content="Mashup templates have been developped by Orson.io team" name="author">

  <!-- Disable tap highlight on IE -->
  <meta name="msapplication-tap-highlight" content="no">
  
  <link rel="apple-touch-icon" sizes="180x180" href="./assets/apple-icon-180x180.png">
  <link href="./assets/favicon.ico" rel="icon">

  <title>Portfolio- Dip Kumar Majumder</title>  

<link href="./main.3f6952e4.css" rel="stylesheet">

<style>
/* Additional styles for NASA image functionality */
.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.9);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  color: white;
  font-size: 1.2rem;
}

.image-info {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: rgba(0, 0, 0, 0.8);
  color: white;
  padding: 15px;
  border-radius: 8px;
  max-width: 300px;
  font-size: 0.9rem;
  z-index: 1000;
  transform: translateX(calc(100% + 20px));
  transition: transform 0.3s ease;
}

.image-info.show {
  transform: translateX(0);
}

.image-info h4 {
  margin: 0 0 8px 0;
  font-size: 1rem;
  color: #4CAF50;
}

.image-info p {
  margin: 5px 0;
  line-height: 1.4;
}

.toggle-info {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: rgba(0, 0, 0, 0.8);
  color: white;
  border: none;
  padding: 10px 15px;
  border-radius: 50%;
  cursor: pointer;
  font-size: 1.2rem;
  z-index: 1001;
  transition: all 0.3s ease;
}

.toggle-info:hover {
  background: rgba(0, 0, 0, 0.9);
  transform: scale(1.1);
}

/* Dynamic text color based on background */
.hero-full-container .text-content h1 {
  transition: color 0.5s ease, text-shadow 0.5s ease;
}

.hero-full-container.dark-bg .text-content h1 {
  color: white;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.hero-full-container.light-bg .text-content h1 {
  color: #222;
  text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.8);
}

.read-more-btn {
  background: none;
  border: none;
  color: #4CAF50;
  cursor: pointer;
  text-decoration: underline;
  font-size: inherit;
  padding: 0;
  margin-left: 5px;
}

.read-more-btn:hover {
  color: #66BB6A;
}

.description-text {
  transition: max-height 0.3s ease;
}

@media (max-width: 768px) {
  .image-info {
    bottom: 80px;
    right: 10px;
    left: 10px;
    max-width: none;
    transform: translateY(100%);
  }
  
  .image-info.show {
    transform: translateY(0);
  }
}
</style>
</head>

<body class="minimal">
<div id="loading" class="loading-overlay" style="display: none;">
  <div>Loading today's space image from NASA...</div>
</div>

<div id="site-border-left"></div>
<div id="site-border-right"></div>
<div id="site-border-top"></div>
<div id="site-border-bottom"></div>
<!-- Add your content of header -->
<header>
  <nav class="navbar  navbar-fixed-top navbar-inverse">
    <div class="container">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

      <div class="collapse navbar-collapse" id="navbar-collapse">
        <ul class="nav navbar-nav ">
          <li><a href="./index.html" title="">01 : Home</a></li>
          <li><a href="./skills.html" title="">02 : Skills</a></li>
          <li><a href="./about.html" title="">03 : About me</a></li>
          <li><a href="./contact.html" title="">04 : Contact</a></li>
        </ul>


      </div> 
    </div>
  </nav>
</header>
<!-- Add your site or app content here -->
  <div id="hero-container" class="hero-full-container background-image-container white-text-container" style="background-image: url('./assets/images/space.jpg')">
    <div class="container">
      <div class="row">
        <div class="col-xs-12">
          <div class="hero-full-wrapper">
            <div class="text-content">
              <h1>Hello,<br>
                <span id="typed-strings">
                  <span>I'm Dip Kumar Majumder</span>
                  <span>An IT Enthusiast</span>
                  <span>A Programmer</span>
                  <span>An Aspiring Data Scientist</span>
                  <span>An AI Enthusiast</span>
                  <span>A Machine Learning Explorer</span>
                  <span>A Creative Problem Solver</span>
                  <span>A Tech Blogger</span>
                  <span>A CS50 Graduate</span>
                  <span>A Python Developer</span>
                  <span>A Lifelong Learner</span>
                </span>
                <span id="typed"></span>
              </h1>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<button class="toggle-info" onclick="toggleImageInfo()">ℹ️</button>

<div id="image-info" class="image-info">
  <h4 id="image-title">NASA Space Image</h4>
  <p><strong>Date:</strong> <span id="image-date">Loading...</span></p>
  <p class="description-text" id="image-description">Loading NASA's Astronomy Picture of the Day...</p>
</div>

<script>
// NASA API Configuration
const NASA_API_KEY = 'BefGt1YgRUkBKnV4Yojhaa78fcUrX1WLATb9mAZJ';
const NASA_APOD_URL = 'https://api.nasa.gov/planetary/apod?api_key=' + NASA_API_KEY;

// Global variables
let currentImageData = null;
let isInfoVisible = false;
let isImageLoaded = false;
let loadingTimeout = null;
let isExpanded = false;

// Debounce function to prevent rapid calls
function debounce(func, wait) {
  let timeout;
  return function executedFunction(...args) {
    const later = function() {
      clearTimeout(timeout);
      func(...args);
    };
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
  };
}

// Show loading overlay with timeout
function showLoading() {
  const loading = document.getElementById('loading');
  if (loading) {
    loading.style.display = 'flex';
    loading.style.opacity = '1';
    
    // Set timeout to hide loading if it takes too long
    loadingTimeout = setTimeout(function() {
      hideLoading();
      setDefaultImageInfo();
    }, 10000); // 10 second timeout
  }
}

// Hide loading overlay
function hideLoading() {
  if (loadingTimeout) {
    clearTimeout(loadingTimeout);
    loadingTimeout = null;
  }
  
  const loading = document.getElementById('loading');
  if (loading) {
    loading.style.opacity = '0';
    setTimeout(function() {
      loading.style.display = 'none';
    }, 300);
  }
}

// Optimized NASA image fetching with better error handling
function fetchNASAImage() {
  if (isImageLoaded) return; // Prevent multiple calls
  
  showLoading();
  
  const controller = new AbortController();
  const timeoutId = setTimeout(() => controller.abort(), 8000); // 8 second timeout
  
  fetch(NASA_APOD_URL, { signal: controller.signal })
    .then(function(response) {
      clearTimeout(timeoutId);
      if (!response.ok) {
        throw new Error('Network response was not ok: ' + response.status);
      }
      return response.json();
    })
    .then(function(data) {
      console.log('NASA API Response received');
      
      // Check if it's an image (not a video)
      if (data.media_type === 'image') {
        setBackgroundImage(data);
      } else {
        // If today's APOD is a video, get yesterday's image
        const yesterday = new Date();
        yesterday.setDate(yesterday.getDate() - 1);
        const yesterdayStr = yesterday.toISOString().split('T')[0];
        
        const fallbackController = new AbortController();
        const fallbackTimeoutId = setTimeout(() => fallbackController.abort(), 5000);
        
        return fetch(NASA_APOD_URL + '&date=' + yesterdayStr, { signal: fallbackController.signal })
          .then(function(response) {
            clearTimeout(fallbackTimeoutId);
            return response.json();
          });
      }
    })
    .then(function(data) {
      if (data && data.media_type === 'image') {
        setBackgroundImage(data);
      } else {
        // Keep original fallback image
        hideLoading();
        setDefaultImageInfo();
      }
    })
    .catch(function(error) {
      console.log('NASA API error:', error.name === 'AbortError' ? 'Request timeout' : error.message);
      hideLoading();
      setDefaultImageInfo();
    });
}

// Optimized background image setting
function setBackgroundImage(imageData) {
  if (isImageLoaded) return; // Prevent multiple image loads
  
  const heroContainer = document.getElementById('hero-container');
  if (!heroContainer) return;
  
  const imageUrl = imageData.hdurl || imageData.url;
  
  // Create a new image to preload
  const img = new Image();
  
  const imageLoadTimeout = setTimeout(function() {
    console.log('Image load timeout, using fallback');
    hideLoading();
    setDefaultImageInfo();
  }, 8000);
  
  img.onload = function() {
    if (isImageLoaded) return; // Prevent duplicate processing
    
    clearTimeout(imageLoadTimeout);
    isImageLoaded = true;
    
    console.log('NASA image loaded successfully');
    heroContainer.style.backgroundImage = "url('" + imageUrl + "')";
    
    // Skip brightness analysis for performance - just use dark background assumption
    heroContainer.classList.remove('light-bg');
    heroContainer.classList.add('dark-bg');
    
    updateImageInfo(imageData);
    hideLoading();
  };
  
  img.onerror = function() {
    clearTimeout(imageLoadTimeout);
    console.log('Image failed to load, keeping original');
    hideLoading();
    setDefaultImageInfo();
  };
  
  img.src = imageUrl;
}

// Set default image info for fallback
function setDefaultImageInfo() {
  const today = new Date().toISOString().split('T')[0];
  updateImageInfo({
    title: 'Space Background',
    explanation: 'Beautiful space imagery to inspire your coding journey. This stunning cosmic view serves as a reminder of the infinite possibilities that await in the world of technology and programming.',
    date: today
  });
}

// Update image information panel with read more functionality
function updateImageInfo(imageData) {
  currentImageData = imageData;
  
  const titleElement = document.getElementById('image-title');
  const dateElement = document.getElementById('image-date');
  const descriptionElement = document.getElementById('image-description');
  
  if (titleElement) titleElement.textContent = imageData.title || 'Space Image';
  if (dateElement) dateElement.textContent = imageData.date || 'Today';
  
  if (descriptionElement) {
    const description = imageData.explanation || 'No description available.';
    
    // Create truncated and full versions
    const maxLength = 150;
    const needsReadMore = description.length > maxLength;
    
    if (needsReadMore) {
      const truncatedText = description.substring(0, maxLength).trim() + '...';
      
      // Create read more button
      const readMoreBtn = document.createElement('button');
      readMoreBtn.className = 'read-more-btn';
      readMoreBtn.textContent = 'Read More';
      readMoreBtn.onclick = function() {
        toggleDescription(description, truncatedText, readMoreBtn);
      };
      
      // Set initial content
      descriptionElement.innerHTML = truncatedText;
      descriptionElement.appendChild(readMoreBtn);
    } else {
      descriptionElement.textContent = description;
    }
  }
}

// Toggle between truncated and full description
function toggleDescription(fullText, truncatedText, button) {
  const descriptionElement = document.getElementById('image-description');
  
  if (isExpanded) {
    // Show truncated version
    descriptionElement.innerHTML = truncatedText;
    descriptionElement.appendChild(button);
    button.textContent = 'Read More';
  } else {
    // Show full version
    const readLessBtn = document.createElement('button');
    readLessBtn.className = 'read-more-btn';
    readLessBtn.textContent = ' Read Less';
    readLessBtn.onclick = function() {
      toggleDescription(fullText, truncatedText, button);
    };
    
    descriptionElement.innerHTML = fullText;
    descriptionElement.appendChild(readLessBtn);
  }
  
  isExpanded = !isExpanded;
}

// Debounced toggle function
const toggleImageInfo = debounce(function() {
  const imageInfo = document.getElementById('image-info');
  if (!imageInfo) return;
  
  isInfoVisible = !isInfoVisible;
  
  if (isInfoVisible) {
    imageInfo.classList.add('show');
  } else {
    imageInfo.classList.remove('show');
  }
}, 100);

// Optimized initialization
function initializeApp() {
  console.log('Initializing portfolio app...');
  
  // Only fetch NASA image if not already loaded
  if (!isImageLoaded) {
    // Add small delay to ensure DOM is fully ready
    setTimeout(fetchNASAImage, 100);
  }
  
  // Auto-show info panel briefly on first load (only once)
  setTimeout(function() {
    if (!isInfoVisible) {
      toggleImageInfo();
      // Auto-hide after 4 seconds
      setTimeout(function() {
        if (isInfoVisible) {
          toggleImageInfo();
        }
      }, 4000);
    }
  }, 2500);
}

// Single event listener with proper cleanup
let isInitialized = false;

document.addEventListener('DOMContentLoaded', function() {
  if (!isInitialized) {
    isInitialized = true;
    initializeApp();
  }
});

// Fallback initialization
if (document.readyState === 'loading') {
  // DOM not ready yet
  document.addEventListener('DOMContentLoaded', function() {
    if (!isInitialized) {
      isInitialized = true;
      initializeApp();
    }
  });
} else {
  // DOM already ready
  if (!isInitialized) {
    isInitialized = true;
    initializeApp();
  }
}

// Cleanup on page unload
window.addEventListener('beforeunload', function() {
  if (loadingTimeout) {
    clearTimeout(loadingTimeout);
  }
});
</script>

<script>
  document.addEventListener("DOMContentLoaded", function (event) {
     type();
     movingBackgroundImage();
  });
</script>

<script type="text/javascript" src="./main.70a66962.js"></script>
</body>

</html>